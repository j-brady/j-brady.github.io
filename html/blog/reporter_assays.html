<!DOCTYPE html>
<html lang="en">
<head>
<!-- 2022-12-28 Wed 12:06 -->
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>NMR Reporter Assays</title>
<meta name="author" content="Jacob P Brady" />
<meta name="generator" content="Org Mode" />
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Alegreya&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/milligram/1.4.1/milligram.css">
<link rel="stylesheet" href="../static/css/style.css">
<style> .org-src-container {padding: 0 18px; display: none; overflow: hidden;} </style>
<script type="text/x-mathjax-config">
    MathJax.Hub.Config({
        displayAlign: "left",
        displayIndent: "0em",

        "HTML-CSS": { scale: 100,
                        linebreaks: { automatic: "false" },
                        webFont: "Neo-Euler"
                       },
        SVG: {scale: 100,
              linebreaks: { automatic: "false" },
              font: "Neo-Euler"},
        NativeMML: {scale: 100},
        TeX: { equationNumbers: {autoNumber: "AMS"},
               MultLineWidth: "85%",
               TagSide: "left",
               TagIndent: ".8em"
             }
});
</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS_HTML"></script>
</head>
<body>
<div id="content" class="content">
<header>
<h1 class="title">NMR Reporter Assays</h1>
</header><hr>
<p>
NMR (Nuclear Magnetic Resonance) is not a high-throughput technique! However, it does have an extremely important role to play in the drug discovery process.
In particular, NMR reporter assays can provide an efficient and reliable means of  ranking compound binding over a wide range of affinities especially in the lower affinity range (μM to mM) where other biophysical techniques (such as SPR) may struggle to reliably quantify and rank binding.
The quantitative information gleaned from NMR reporter assays can be used to guide medicinal chemistry efforts and develop an understanding of the structure activity relationship (SAR).
</p>

<p>
A reporter assay works by observing the displacement of a reporter molecule by a competitor molecule that binds to the same or overlapping site on a biomolecule.
In the case of an NMR reporter assay the signal of the reporter is highly attenuated in the presence of the biomolecule of interest.
Upon addition of a competitor molecule a recovery of the reporter signal intensity is observed.
The percentage of displacement (recovery of signal) of the reporter can then be quantified and used to determine the affinity or \(IC_{50}\) of the competitor.
This is a potentially efficient method of ranking compounds by affinity as it does not require large amounts of biomolecule (relative to 2D NMR methods) and it is possible to gain robust estimates of competitor affinities with as few as 3 data points per sample. Additionally, experimental times are much shorter as only 1D or pseudo 2D (2-3 \(T_2\) times) are required per dataset.
</p>

<p>
In general, three samples are required for an NMR reporter assay:
</p>
<ol class="org-ol">
<li>Reporter only (negative control)</li>
<li>Reporter + protein (positive control)</li>
<li>Reporter + protein + competitor</li>
</ol>

<p>
It is also prudent to include an internal reference compound which does not interact with your biomolecule of interest.
This internal control can be used to normalize your data and account for issues with sample homogeneity and shimming problems etc.
</p>

<p>
A good reporter molecule should have the following qualities:
</p>

<ol class="org-ol">
<li>Specific stoichiometric (1:1) binder i.e. compound binding site is unique</li>
<li>\(K_d\) known (this is not an absolute requirement but is necessary for quantification of \(K_i\) values)</li>
<li>Large contrast in \(R_2\) between bound and free conditions in a concentration range that allows for acquisition of high signal to noise data.</li>
<li>Fast \(k_{off}\) (fast exchange on NMR timescale). Should not have measurable kinetics by SPR (i.e. \(k_{off}\) &gt; 2 \(s^{-1}\)).</li>
</ol>


<p>
A key advantage of NMR based reporter assays over other techniques such as fluorescence polarisation (FP) is that a sensitive assay can be achieved at much lower bound ligand fractions.
For example, a typical FP assay requires an \(f_0\) of \(0.5-0.8\) whereas an NMR assay can be highly sensitive with \(f_0\) values as low as 0.003.
This means that the measurable range of \(K_i\) values by NMR reporter assays is around 2 orders of magnitude wider (see <a href="#org2163618">IC50</a>).
</p>

<p>
Below is a schematic showing the key experimental read-outs of a reporter assay (see <a href="#org3e5e38d">Assay quality metrics</a> for more details). On the left is the reporter only sample for which a sharp intense reporter signal is observed.
Upon addition of protein to the sample the reporter signal is greatly attenuated  (centre) due to the reporter binding to a specific site on the protein.
Addition of a competitor molecule (right) leads to a recovery of signal intensity due competition for binding to the same site on the protein and hence a reduction in the bound fraction of reporter.
</p>

<button type="button" class="collapsible">Show code</button>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #859900; font-weight: bold; font-style: italic;">import</span> nmrglue <span style="color: #859900; font-weight: bold; font-style: italic;">as</span> ng
<span style="color: #859900; font-weight: bold; font-style: italic;">import</span> numpy <span style="color: #859900; font-weight: bold; font-style: italic;">as</span> np
<span style="color: #859900; font-weight: bold; font-style: italic;">import</span> matplotlib
matplotlib.use(<span style="color: #2aa198;">'Agg'</span>)
<span style="color: #859900; font-weight: bold; font-style: italic;">import</span> matplotlib.pyplot <span style="color: #859900; font-weight: bold; font-style: italic;">as</span> plt

<span style="color: #859900; font-weight: bold; font-style: italic;">def</span> <span style="color: #b58900;">I</span>(I0: <span style="color: #d33682; font-style: italic;">float</span>, R2: <span style="color: #d33682; font-style: italic;">float</span>, tau: <span style="color: #d33682; font-style: italic;">float</span>) -&gt; <span style="color: #d33682; font-style: italic;">float</span>:
   <span style="color: #859900; font-weight: bold; font-style: italic;">return</span> I0*np.exp(-<span style="color: #6c71c4; font-weight: bold;">1.0</span>*R2*tau)

<span style="color: #859900; font-weight: bold; font-style: italic;">def</span> <span style="color: #b58900;">C2</span>(R2_protein,R2_free):
   <span style="color: #859900; font-weight: bold; font-style: italic;">return</span> (R2_protein - R2_free) / R2_protein

<span style="color: #96A7A9; font-style: italic;"># </span><span style="color: #96A7A9; font-style: italic;">setup parameters</span>
<span style="color: #268bd2;">R2_protein</span> = <span style="color: #6c71c4; font-weight: bold;">10.0</span> <span style="color: #96A7A9; font-style: italic;"># </span><span style="color: #96A7A9; font-style: italic;">s-1</span>
<span style="color: #268bd2;">R2_free</span> = <span style="color: #6c71c4; font-weight: bold;">2.0</span> <span style="color: #96A7A9; font-style: italic;"># </span><span style="color: #96A7A9; font-style: italic;">s-1</span>
<span style="color: #268bd2;">R2_comp</span> = <span style="color: #6c71c4; font-weight: bold;">5.0</span> <span style="color: #96A7A9; font-style: italic;"># </span><span style="color: #96A7A9; font-style: italic;">s-1</span>
<span style="color: #268bd2;">tau_long</span> = <span style="color: #6c71c4; font-weight: bold;">0.240</span> <span style="color: #96A7A9; font-style: italic;"># </span><span style="color: #96A7A9; font-style: italic;">s</span>
<span style="color: #268bd2;">tau_short</span> = <span style="color: #6c71c4; font-weight: bold;">0.080</span> <span style="color: #96A7A9; font-style: italic;"># </span><span style="color: #96A7A9; font-style: italic;">s</span>
<span style="color: #268bd2;">I0</span> = <span style="color: #6c71c4; font-weight: bold;">1.0</span>

<span style="color: #268bd2;">I_free_short</span> = I(I0,R2_free,tau_short)
<span style="color: #268bd2;">I_free_long</span> = I(I0,R2_free,tau_long)
<span style="color: #268bd2;">I_protein_short</span> = I(I0,R2_protein,tau_short)
<span style="color: #268bd2;">I_protein_long</span> = I(I0,R2_protein,tau_long)
<span style="color: #268bd2;">I_comp_short</span> = I(I0,R2_comp,tau_short)
<span style="color: #268bd2;">I_comp_long</span> = I(I0,R2_comp,tau_long)

<span style="color: #268bd2;">peak_tau_short_free</span> = ng.linesh.sim_NDregion((<span style="color: #6c71c4; font-weight: bold;">50</span>,),[<span style="color: #2aa198;">'l'</span>],[[(<span style="color: #6c71c4; font-weight: bold;">25</span>,R2_free/np.pi)]],[I_free_short])
<span style="color: #268bd2;">peak_tau_long_free</span> = ng.linesh.sim_NDregion((<span style="color: #6c71c4; font-weight: bold;">50</span>,),[<span style="color: #2aa198;">'l'</span>],[[(<span style="color: #6c71c4; font-weight: bold;">25</span>,R2_free/np.pi)]],[I_free_long])
<span style="color: #268bd2;">peak_tau_short_protein</span> = ng.linesh.sim_NDregion((<span style="color: #6c71c4; font-weight: bold;">50</span>,),[<span style="color: #2aa198;">'l'</span>],[[(<span style="color: #6c71c4; font-weight: bold;">25</span>,R2_protein/np.pi)]],[I_protein_short])
<span style="color: #268bd2;">peak_tau_long_protein</span> = ng.linesh.sim_NDregion((<span style="color: #6c71c4; font-weight: bold;">50</span>,),[<span style="color: #2aa198;">'l'</span>],[[(<span style="color: #6c71c4; font-weight: bold;">25</span>,R2_protein/np.pi)]],[I_protein_long])
<span style="color: #268bd2;">peak_tau_short_comp</span> = ng.linesh.sim_NDregion((<span style="color: #6c71c4; font-weight: bold;">50</span>,),[<span style="color: #2aa198;">'l'</span>],[[(<span style="color: #6c71c4; font-weight: bold;">25</span>,R2_comp/np.pi)]],[I_comp_short])
<span style="color: #268bd2;">peak_tau_long_comp</span> = ng.linesh.sim_NDregion((<span style="color: #6c71c4; font-weight: bold;">50</span>,),[<span style="color: #2aa198;">'l'</span>],[[(<span style="color: #6c71c4; font-weight: bold;">25</span>,R2_comp/np.pi)]],[I_comp_long])

<span style="color: #268bd2;">contrast_R2</span> = C2(R2_protein,R2_free)
<span style="color: #268bd2;">contrast_R2_text</span> = r<span style="color: #2aa198;">"$\frac{%.1f-%.1f}{%.1f}={%.1f}$"</span>%(R2_protein,R2_free,R2_protein,contrast_R2)
<span style="color: #268bd2;">ratio_protein</span> = np.log(I_protein_long / I_protein_short)
<span style="color: #268bd2;">ratio_free</span> = np.log(I_free_long / I_free_short)
<span style="color: #268bd2;">contrast_ratio</span> = C2(ratio_protein,ratio_free)

<span style="color: #268bd2;">contrast_ratio_text</span> = r<span style="color: #2aa198;">"$I_{80ms,free}=%.3f$"</span>%(I_free_short) + <span style="color: #2aa198;">"\n"</span>
<span style="color: #268bd2;">contrast_ratio_text</span> += r<span style="color: #2aa198;">"$I_{240ms,free}=%.3f$"</span>%(I_free_long) + <span style="color: #2aa198;">"\n"</span>
<span style="color: #268bd2;">contrast_ratio_text</span> += r<span style="color: #2aa198;">"$I_{80ms,protein}=%.3f$"</span>%(I_protein_short) + <span style="color: #2aa198;">"\n"</span>
<span style="color: #268bd2;">contrast_ratio_text</span> += r<span style="color: #2aa198;">"$I_{240ms,protein}=%.3f$"</span>%(I_protein_long) + <span style="color: #2aa198;">"\n"</span>
<span style="color: #268bd2;">contrast_ratio_text</span> += <span style="color: #2aa198;">"Ratio method\n"</span>
<span style="color: #268bd2;">contrast_ratio_text</span> += r<span style="color: #2aa198;">"$\frac{%.3f-%.3f}{%.3f}={%.3f}$"</span>%(ratio_protein,ratio_free,ratio_protein,contrast_ratio)
<span style="color: #268bd2;">contrast_ratio_text</span> += <span style="color: #2aa198;">"\n"</span>+r<span style="color: #2aa198;">"$R_2$ method"</span>+<span style="color: #2aa198;">"\n"</span>
<span style="color: #268bd2;">contrast_ratio_text</span> += contrast_R2_text
<span style="color: #268bd2;">bbox</span> = <span style="color: #d33682; font-style: italic;">dict</span>(boxstyle=<span style="color: #2aa198;">"round"</span>,
            ec=<span style="color: #2aa198;">"g"</span>,
            fc=<span style="color: #2aa198;">"g"</span>,
            alpha=<span style="color: #6c71c4; font-weight: bold;">0.5</span>)
bbox_caption = <span style="color: #d33682; font-style: italic;">dict</span>(boxstyle=<span style="color: #2aa198;">"round"</span>,
            ec=<span style="color: #2aa198;">"b"</span>,
            fc=<span style="color: #2aa198;">"b"</span>,
            alpha=<span style="color: #6c71c4; font-weight: bold;">0.5</span>)

<span style="color: #96A7A9; font-style: italic;"># </span><span style="color: #96A7A9; font-style: italic;">make plot</span>
fig, (<span style="color: #268bd2;">ax1</span>,<span style="color: #268bd2;">ax2</span>,<span style="color: #268bd2;">ax3</span>) = plt.subplots(<span style="color: #6c71c4; font-weight: bold;">1</span>,<span style="color: #6c71c4; font-weight: bold;">3</span>, figsize=(<span style="color: #6c71c4; font-weight: bold;">10</span>,<span style="color: #6c71c4; font-weight: bold;">4</span>))
long_dict = <span style="color: #d33682; font-style: italic;">dict</span>(linestyle=<span style="color: #2aa198;">"-"</span>,color=<span style="color: #2aa198;">"r"</span>,alpha=<span style="color: #6c71c4; font-weight: bold;">1.0</span>,linewidth=<span style="color: #6c71c4; font-weight: bold;">2</span>)
short_dict = <span style="color: #d33682; font-style: italic;">dict</span>(linestyle=<span style="color: #2aa198;">"--"</span>,color=<span style="color: #2aa198;">"k"</span>,alpha=<span style="color: #6c71c4; font-weight: bold;">0.5</span>,linewidth=<span style="color: #6c71c4; font-weight: bold;">1</span>)
ax1.plot(peak_tau_short_free,label=f<span style="color: #2aa198;">"</span>{tau_short}<span style="color: #2aa198;">"</span>,**short_dict)
ax1.plot(peak_tau_long_free,label=f<span style="color: #2aa198;">"</span>{tau_long}<span style="color: #2aa198;">"</span>,**long_dict)
ax2.plot(peak_tau_short_protein,label=f<span style="color: #2aa198;">"</span>{tau_short}<span style="color: #2aa198;">"</span>, **short_dict)
ax2.plot(peak_tau_long_protein,label=f<span style="color: #2aa198;">"</span>{tau_long}<span style="color: #2aa198;">"</span>, **long_dict)
ax3.plot(peak_tau_short_comp,label=f<span style="color: #2aa198;">"</span>{tau_short}<span style="color: #2aa198;">"</span>, **short_dict)
ax3.plot(peak_tau_long_comp,label=f<span style="color: #2aa198;">"</span>{tau_long}<span style="color: #2aa198;">"</span>, **long_dict)
ax1.text(<span style="color: #6c71c4; font-weight: bold;">0.0</span>,<span style="color: #6c71c4; font-weight: bold;">0.3</span>,<span style="color: #2aa198;">"full signal"</span>,transform=ax1.transAxes, bbox=bbox)
ax2.text(<span style="color: #6c71c4; font-weight: bold;">0.0</span>,<span style="color: #6c71c4; font-weight: bold;">0.3</span>,<span style="color: #2aa198;">"signal attenuated"</span>,transform=ax2.transAxes, bbox=bbox)
ax3.text(<span style="color: #6c71c4; font-weight: bold;">0.0</span>,<span style="color: #6c71c4; font-weight: bold;">0.3</span>,<span style="color: #2aa198;">"signal recovered"</span>,transform=ax3.transAxes, bbox=bbox)
ax2.text(<span style="color: #6c71c4; font-weight: bold;">0.0</span>,<span style="color: #6c71c4; font-weight: bold;">0.5</span>,contrast_ratio_text,
         transform=ax2.transAxes,
         bbox=bbox_caption, color=<span style="color: #2aa198;">"white"</span>, fontsize=<span style="color: #2aa198;">"x-small"</span>)
<span style="color: #859900; font-weight: bold; font-style: italic;">for</span> ax <span style="color: #859900; font-weight: bold; font-style: italic;">in</span> [ax1,ax2,ax3]:
    ax.set_ylim(<span style="color: #6c71c4; font-weight: bold;">0</span>,<span style="color: #6c71c4; font-weight: bold;">1</span>)
    ax.legend(title=r<span style="color: #2aa198;">"$T_2$ filter time (s)"</span>)
    ax.axis(<span style="color: #2aa198;">"off"</span>)
ax1.set_title(<span style="color: #2aa198;">"Reporter only"</span>)
ax2.set_title(<span style="color: #2aa198;">"Reporter + protein"</span>)
ax3.set_title(<span style="color: #2aa198;">"Reporter + protein + competitor"</span>)
plt.suptitle(r<span style="color: #2aa198;">"Contrast $(C_2)$ = "</span>+f<span style="color: #2aa198;">"</span>{contrast_R2:.1f}<span style="color: #2aa198;">"</span>)
fname = <span style="color: #2aa198;">"../static/contrast.png"</span>
plt.tight_layout()
plt.savefig(fname)
<span style="color: #859900; font-weight: bold; font-style: italic;">return</span> fname
</pre>
</div>


<figure id="org217a35b">
<img src="../static/contrast.png" alt="contrast.png">

</figure>

<hr>
<div id="outline-container-org8122d99" class="outline-2">
<h2 id="org8122d99">Theory</h2>
<div class="outline-text-2" id="text-org8122d99">
</div>
<div id="outline-container-orga877662" class="outline-3">
<h3 id="orga877662">Simple binding model</h3>
<div class="outline-text-3" id="text-orga877662">
<p>
In the absence of a competitor the fraction of bound reporter is calculated using the following logic.
</p>

\begin{equation}
K_d=\frac{[P][L]}{[PL]}
\end{equation}

<p>
Where \([P]\) and \([L]\) are the free protein and reporter concentrations and \([PL]\) is the bound concentration.
</p>

<p>
Using the mass conservation law, the free reporter and protein concentrations can be expressed in terms of the bound concentration and the total reporter and protein concentrations (\([L]_T\) and \([P]_T\), respectively):
</p>

\begin{equation}
[P] = [P]_T - [PL]
\end{equation}

\begin{equation}
[L] = [L]_T - [PL]
\end{equation}

<p>
Substituting these into the \(K_d\) equation gives
</p>

\begin{equation}
K_d=\frac{([P]_T - [PL])([L]_T - [PL])}{[PL]}
\end{equation}

<p>
Which can be rearranged into a quadratic form to solve for \([PL]\).
</p>

\begin{equation}
[PL] = \frac{([P]_T+[L]_T+K_d)-\sqrt{-([P]_T+[L]_T+K_d)^2 - 4[P]_T[L]_T}}{2}
\end{equation}

<p>
Since the fraction of bound reporter, \(f_0=\frac{[PL]}{[L_T]}\)
</p>

\begin{equation}
f_0 = \frac{([P]_T+[L]_T+K_d)-\sqrt{-([P]_T+[L]_T+K_d)^2 - 4[P]_T[L]_T}}{2[L]_T}
\end{equation}

<p>
The plot below shows the bound fraction of reporter across a typical range of conditions that was tested by Vieira de Castro and Ciulli (2019).
It is clear the protein concentration has a more significant effect on the bound fraction than the reporter concentration in this experimental range.
Selecting a reporter and protein concentration becomes a trade off between having high \(C_2\), \(Z'\) and signal to noise.
In this case, a good assay could be developed by selecting 50 μM reporter and 0.5-1 μM protein.
</p>

<button type="button" class="collapsible">Show code</button>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #859900; font-weight: bold; font-style: italic;">import</span> numpy <span style="color: #859900; font-weight: bold; font-style: italic;">as</span> np
<span style="color: #859900; font-weight: bold; font-style: italic;">import</span> pandas <span style="color: #859900; font-weight: bold; font-style: italic;">as</span> pd
<span style="color: #859900; font-weight: bold; font-style: italic;">import</span> matplotlib.pyplot <span style="color: #859900; font-weight: bold; font-style: italic;">as</span> plt
<span style="color: #859900; font-weight: bold; font-style: italic;">import</span> matplotlib
matplotlib.use(<span style="color: #2aa198;">'Agg'</span>)

<span style="color: #859900; font-weight: bold; font-style: italic;">def</span> <span style="color: #b58900;">f0</span>(Pt: <span style="color: #d33682; font-style: italic;">float</span>, Lt: <span style="color: #d33682; font-style: italic;">float</span>, Kd: <span style="color: #d33682; font-style: italic;">float</span>) -&gt; <span style="color: #d33682; font-style: italic;">float</span>:
    <span style="color: #35a69c; font-style: italic;">""" calculate fraction of bound ligand for 1:1 binding model</span>

<span style="color: #35a69c; font-style: italic;">        Parameters</span>
<span style="color: #35a69c; font-style: italic;">        ----------</span>
<span style="color: #35a69c; font-style: italic;">        Pt : float</span>
<span style="color: #35a69c; font-style: italic;">            total concentration of protein (M)</span>
<span style="color: #35a69c; font-style: italic;">        Lt : float</span>
<span style="color: #35a69c; font-style: italic;">            total concentration of ligand (M)</span>
<span style="color: #35a69c; font-style: italic;">        Kd : float</span>
<span style="color: #35a69c; font-style: italic;">            dissociation constant (M)</span>

<span style="color: #35a69c; font-style: italic;">        Returns</span>
<span style="color: #35a69c; font-style: italic;">        -------</span>
<span style="color: #35a69c; font-style: italic;">        f : float</span>
<span style="color: #35a69c; font-style: italic;">            fraction of ligand bound to protein</span>

<span style="color: #35a69c; font-style: italic;">    """</span>
    a = <span style="color: #6c71c4; font-weight: bold;">1.0</span>
    <span style="color: #268bd2;">b</span> = -<span style="color: #6c71c4; font-weight: bold;">1.0</span>*(Pt+Lt+Kd)
    <span style="color: #268bd2;">c</span> = Pt*Lt
    <span style="color: #859900; font-weight: bold; font-style: italic;">return</span> (-b-np.sqrt(b**<span style="color: #6c71c4; font-weight: bold;">2</span>-<span style="color: #6c71c4; font-weight: bold;">4</span>*a*c))/(<span style="color: #6c71c4; font-weight: bold;">2</span>*Lt)

<span style="color: #268bd2;">Pt</span> = [<span style="color: #6c71c4; font-weight: bold;">0.125</span>,<span style="color: #6c71c4; font-weight: bold;">0.250</span>,<span style="color: #6c71c4; font-weight: bold;">0.500</span>,<span style="color: #6c71c4; font-weight: bold;">1.000</span>]
<span style="color: #268bd2;">Lt</span> = [<span style="color: #6c71c4; font-weight: bold;">5</span>,<span style="color: #6c71c4; font-weight: bold;">10</span>,<span style="color: #6c71c4; font-weight: bold;">25</span>,<span style="color: #6c71c4; font-weight: bold;">50</span>,<span style="color: #6c71c4; font-weight: bold;">100</span>]
<span style="color: #268bd2;">Kd</span> = <span style="color: #6c71c4; font-weight: bold;">145.0</span>
<span style="color: #268bd2;">fs</span> = [[<span style="color: #2aa198;">"Protein"</span>,<span style="color: #2aa198;">"Reporter"</span>,<span style="color: #2aa198;">"Fraction"</span>],]
<span style="color: #859900; font-weight: bold; font-style: italic;">for</span> p <span style="color: #859900; font-weight: bold; font-style: italic;">in</span> <span style="color: #268bd2;">Pt</span>:
    <span style="color: #859900; font-weight: bold; font-style: italic;">for</span> l <span style="color: #859900; font-weight: bold; font-style: italic;">in</span> Lt:
        f = f0(p,l,Kd)
        fs.append([p,l,f])
<span style="color: #268bd2;">df</span> = pd.DataFrame(fs[<span style="color: #6c71c4; font-weight: bold;">1</span>:],columns=fs[<span style="color: #6c71c4; font-weight: bold;">0</span>])
<span style="color: #859900; font-weight: bold; font-style: italic;">for</span> name, group <span style="color: #859900; font-weight: bold; font-style: italic;">in</span> df.groupby(<span style="color: #2aa198;">"Protein"</span>):
    plt.plot(group.Reporter, group.Fraction,<span style="color: #2aa198;">"o-"</span>,label=f<span style="color: #2aa198;">"</span>{name:.2f}<span style="color: #2aa198;">"</span>)

plt.legend(title=<span style="color: #2aa198;">"[Protein] - &#956;M"</span>)
plt.xlabel(<span style="color: #2aa198;">"[Reporter] - &#956;M"</span>)
plt.ylabel(r<span style="color: #2aa198;">"fraction of bound reporter - $f_0$"</span>)
plt.title(<span style="color: #2aa198;">"Reporter 19 ($K_d=145\pm29$ &#956;M) from Vieira de Castro and Ciulli (2019)"</span>)
fname = <span style="color: #2aa198;">"../static/fraction_bound.png"</span>
plt.savefig(fname)
<span style="color: #859900; font-weight: bold; font-style: italic;">return</span> fname
</pre>
</div>


<figure id="orgb4cb7f4">
<img src="../static/fraction_bound.png" alt="fraction_bound.png">

</figure>
</div>
</div>

<div id="outline-container-org2163618" class="outline-3">
<h3 id="org2163618">IC50</h3>
<div class="outline-text-3" id="text-org2163618">
<p>
This is defined as the total competitor concentration (i.e. \([I]+[PI]\) or free competitor + bound competitor, resp) required to reduce the fraction of bound reporter ligand by 50% (\(f=f_0/2\)).
</p>

\begin{equation}
 IC_{50} = [I] + [PI] = \left( \frac{f_0 K_d}{(1-f_0)(2-f_0)} + \frac{f_0 L_0}{2} \right) \left( \frac{K_i(2-f_0)}{K_d f_0}+1 \right)
\end{equation}

<p>
The following graph demonstrates the range of \(IC_{50}\) values that it would be possible to measure using a competition assay for a given reporter \(K_d\) and fraction of bound receptor (\(f_0\)).
The point at which the slope starts to tend towards 0 represents the lower limit of \(K_i\) that could be accurately measured by the assay.
The smaller the \(f_0\) the greater the range of \(IC_{50}\) values that can be measured.
NMR based reporter assays have the advantage of being sensitive to a wide range of \(IC_{50}\) values since these assays can be effectively performed at very low \(f_0\) values (\(f_0\) ~ 0.005). There is a trade off between achieving a low \(f_0\) and a high enough signal to noise (\(S/N\)) ratio and \(C_2\) value to give a robust assay.
</p>

<button type="button" class="collapsible">Show code</button>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #859900; font-weight: bold; font-style: italic;">from</span> typing <span style="color: #859900; font-weight: bold; font-style: italic;">import</span> Union
<span style="color: #859900; font-weight: bold; font-style: italic;">import</span> numpy <span style="color: #859900; font-weight: bold; font-style: italic;">as</span> np
<span style="color: #859900; font-weight: bold; font-style: italic;">import</span> matplotlib
matplotlib.use(<span style="color: #2aa198;">'Agg'</span>)
<span style="color: #859900; font-weight: bold; font-style: italic;">import</span> matplotlib.pyplot <span style="color: #859900; font-weight: bold; font-style: italic;">as</span> plt

<span style="color: #859900; font-weight: bold; font-style: italic;">def</span> <span style="color: #b58900;">calcIC50</span>(Ki: Union[<span style="color: #d33682; font-style: italic;">float</span>, np.array], Kd: <span style="color: #d33682; font-style: italic;">float</span>,f0: <span style="color: #d33682; font-style: italic;">float</span>, L0: <span style="color: #d33682; font-style: italic;">float</span>) -&gt; Union[<span style="color: #d33682; font-style: italic;">float</span>, np.array]:
    <span style="color: #35a69c; font-style: italic;">""" calculate IC50 value</span>

<span style="color: #35a69c; font-style: italic;">        Parameters</span>
<span style="color: #35a69c; font-style: italic;">        ----------</span>
<span style="color: #35a69c; font-style: italic;">        Ki : float | np.array</span>
<span style="color: #35a69c; font-style: italic;">            dissociation constant of competitor (M)</span>
<span style="color: #35a69c; font-style: italic;">        Kd : float</span>
<span style="color: #35a69c; font-style: italic;">            dissociation constant of reporter (M)</span>
<span style="color: #35a69c; font-style: italic;">        f0 : float</span>
<span style="color: #35a69c; font-style: italic;">            initial bound fraction of reporter</span>
<span style="color: #35a69c; font-style: italic;">        L0 : float</span>
<span style="color: #35a69c; font-style: italic;">            reporter concentration in (M)</span>

<span style="color: #35a69c; font-style: italic;">        Returns</span>
<span style="color: #35a69c; font-style: italic;">        -------</span>
<span style="color: #35a69c; font-style: italic;">        ic50 : float | np.array</span>
<span style="color: #35a69c; font-style: italic;">            concentration of competitor at which 50% displacement is achieved</span>
<span style="color: #35a69c; font-style: italic;">            i.e. f = f0/2</span>

<span style="color: #35a69c; font-style: italic;">    """</span>
    <span style="color: #268bd2;">ic50</span> = ((f0*Kd)/((<span style="color: #6c71c4; font-weight: bold;">1.0</span>-f0)*(<span style="color: #6c71c4; font-weight: bold;">2.0</span>-f0)) + (f0*L0)/<span style="color: #6c71c4; font-weight: bold;">2.0</span>) * ((Ki*(<span style="color: #6c71c4; font-weight: bold;">2.0</span>-f0))/(Kd*f0)+<span style="color: #6c71c4; font-weight: bold;">1.0</span>)
    <span style="color: #859900; font-weight: bold; font-style: italic;">return</span> ic50

<span style="color: #268bd2;">Kd</span> = 50e-<span style="color: #6c71c4; font-weight: bold;">6</span> <span style="color: #96A7A9; font-style: italic;"># </span><span style="color: #96A7A9; font-style: italic;">50 &#956;M</span>
<span style="color: #268bd2;">Ki</span> = np.logspace(-<span style="color: #6c71c4; font-weight: bold;">9</span>,-<span style="color: #6c71c4; font-weight: bold;">3</span>)
<span style="color: #268bd2;">L0</span> = 50e-<span style="color: #6c71c4; font-weight: bold;">6</span> <span style="color: #96A7A9; font-style: italic;"># </span><span style="color: #96A7A9; font-style: italic;">reporter concentration</span>
<span style="color: #268bd2;">f0s</span> = [<span style="color: #6c71c4; font-weight: bold;">0.005</span>,<span style="color: #6c71c4; font-weight: bold;">0.05</span>,<span style="color: #6c71c4; font-weight: bold;">0.5</span>] <span style="color: #96A7A9; font-style: italic;"># </span><span style="color: #96A7A9; font-style: italic;">fraction of bound ligand</span>
<span style="color: #859900; font-weight: bold; font-style: italic;">for</span> f0 <span style="color: #859900; font-weight: bold; font-style: italic;">in</span> <span style="color: #268bd2;">f0s</span>:
    ic50 = calcIC50(Ki,Kd,f0,L0)
    plt.loglog(Ki,ic50,<span style="color: #2aa198;">"o-"</span>,label=f<span style="color: #2aa198;">"f0 = </span>{f0}<span style="color: #2aa198;">"</span>)
plt.grid(linestyle=<span style="color: #2aa198;">"--"</span>,alpha=<span style="color: #6c71c4; font-weight: bold;">0.75</span>)
plt.ylabel(<span style="color: #2aa198;">"IC$_{50}$ (M)"</span>)
plt.xlabel(<span style="color: #2aa198;">"K$_{i}$ (M)"</span>)
plt.legend(title=f<span style="color: #2aa198;">"Kd = </span>{Kd*1e6:.1f}<span style="color: #2aa198;"> &#956;M"</span>)
fname = <span style="color: #2aa198;">"../static/ic50.png"</span>
plt.savefig(fname)
<span style="color: #859900; font-weight: bold; font-style: italic;">return</span> fname
</pre>
</div>


<figure id="orgb589d6b">
<img src="../static/ic50.png" alt="ic50.png">

</figure>
</div>
</div>

<div id="outline-container-orgdddada4" class="outline-3">
<h3 id="orgdddada4">Competitive binding model</h3>
<div class="outline-text-3" id="text-orgdddada4">
<p>
An exact mathematical expression for competitive binding was defined by Wang (1994).
For a simple 1:1 binding systems this involves solving a quadratic expression (see <a href="#orga877662">Simple binding model</a>).
However, for a competitive binding system a cubic expression must be solved (see <a href="https://en.wikipedia.org/wiki/Cubic_equation">https://en.wikipedia.org/wiki/Cubic_equation</a>).
</p>

<p>
The following reaction scheme describes a competition experiment:
</p>

\begin{equation}
[PL] + [I] \rightleftharpoons^{K_d} [P] + [L] + [I] \rightleftharpoons^{K_i} [PI] + [L]
\end{equation}

<p>
Where \([P]\), \([L]\) and \([I]\) are protein, reporter and competitor concentrations and \([PL]\) and \([PI]\) are the bound reporter and bound competitor concentrations respectively.
</p>

\begin{equation}
K_d = \frac{[E][L]}{[EL]}
\end{equation}

\begin{equation}
K_i = \frac{[E][I]}{[EI]}
\end{equation}

<p>
and
</p>

\begin{equation}
L_0 = [L] + [EL]
\end{equation}

\begin{equation}
I_0 = [I] + [EI]
\end{equation}

\begin{equation}
E_0 = [E] + [EL] + [EI]
\end{equation}

<p>
The solution is found with a cubic expression and Wang (1995) showed that this can be solved using one of the unique and physically meaningful cubic roots shown below.
</p>

\begin{equation}
a = K_d + K_i + L_0 + I_0 - E_0
\end{equation}

\begin{equation}
b = K_d(I_0-E_0) + K_i(L_0-E_0) + K_dK_i
\end{equation}

\begin{equation}
\theta = \arccos \frac{-2a^3 + 9ab -27c}{2\sqrt{(a^2-3b)^3}}
\end{equation}

\begin{equation}
d = 2\sqrt{(a^2-3b)}\cos{\frac{\theta}{3}}-a
\end{equation}

\begin{equation}
[EL] = \frac{L_0d}{3K_dd}
\end{equation}

<p>
Since fraction of bound ligand is \(f=\frac{[EL]}{L_0}\) then
</p>

\begin{equation}
f = \frac{d}{3K_d+d}
\end{equation}

<p>
Below is a plot showing simulated IC50 curves and demonstrates the range of \(Ki\) values that it would be possible to accurately measure using a model reporter system with the following experimental parameters:
</p>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Parameter</th>
<th scope="col" class="org-left">Value</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">[Protein]</td>
<td class="org-left">1 μM</td>
</tr>

<tr>
<td class="org-left">[Reporter]</td>
<td class="org-left">50 μM</td>
</tr>

<tr>
<td class="org-left">Reporter \(K_d\)</td>
<td class="org-left">5 or 500 μM</td>
</tr>

<tr>
<td class="org-left">\(K_i\) range</td>
<td class="org-left">1nM - 1mM</td>
</tr>
</tbody>
</table>

<p>
Weaker reporters allow for a wider range of \(K_i\) measurements. Due to limitations with small molecule solubility it is unlikely that competitor concentrations greater than 1 mM are accessible.
For example, this means that for a  5 μM \(K_d\) reporter the upper limit for observing full displacement is  around the low μM \(K_i\) range, whereas for a weaker 500 μM  \(K_d\) reporter almost 100% displacement can be achieved in the high μM \(K_i\) range upon addition of 1 mM of competitor.
</p>

<button type="button" class="collapsible">Show code</button>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #859900; font-weight: bold; font-style: italic;">from</span> typing <span style="color: #859900; font-weight: bold; font-style: italic;">import</span> Union
<span style="color: #859900; font-weight: bold; font-style: italic;">from</span> cycler <span style="color: #859900; font-weight: bold; font-style: italic;">import</span> cycler
<span style="color: #859900; font-weight: bold; font-style: italic;">import</span> numpy <span style="color: #859900; font-weight: bold; font-style: italic;">as</span> np
<span style="color: #859900; font-weight: bold; font-style: italic;">import</span> matplotlib
<span style="color: #859900; font-weight: bold; font-style: italic;">from</span> matplotlib <span style="color: #859900; font-weight: bold; font-style: italic;">import</span> cm
matplotlib.use(<span style="color: #2aa198;">'Agg'</span>)
<span style="color: #859900; font-weight: bold; font-style: italic;">import</span> matplotlib.pyplot <span style="color: #859900; font-weight: bold; font-style: italic;">as</span> plt

<span style="color: #859900; font-weight: bold; font-style: italic;">def</span> <span style="color: #b58900;">calcF</span>(I: Union[<span style="color: #d33682; font-style: italic;">float</span>,np.array], Lt: <span style="color: #d33682; font-style: italic;">float</span>, Ki: <span style="color: #d33682; font-style: italic;">float</span>, Kd: <span style="color: #d33682; font-style: italic;">float</span>, Et: <span style="color: #d33682; font-style: italic;">float</span>) -&gt; Union[<span style="color: #d33682; font-style: italic;">float</span>, np.array]:
    <span style="color: #35a69c; font-style: italic;">""" Calculate the fraction of bound reporter</span>

<span style="color: #35a69c; font-style: italic;">        Wang (1995) defined an exact analytical solution to competitive binding.</span>
<span style="color: #35a69c; font-style: italic;">        The following is a slight rearrangement of equation 14 to obtain the bound</span>
<span style="color: #35a69c; font-style: italic;">        fraction of ligand based on the unique physically meaningful root of the</span>
<span style="color: #35a69c; font-style: italic;">        cubic expression.</span>

<span style="color: #35a69c; font-style: italic;">        Parameters</span>
<span style="color: #35a69c; font-style: italic;">        ----------</span>
<span style="color: #35a69c; font-style: italic;">        I : float | np.array</span>
<span style="color: #35a69c; font-style: italic;">            concentration of competitor in M</span>
<span style="color: #35a69c; font-style: italic;">        Lt : float</span>
<span style="color: #35a69c; font-style: italic;">            total concentration of reporter `L_t` in M</span>
<span style="color: #35a69c; font-style: italic;">        Ki : float</span>
<span style="color: #35a69c; font-style: italic;">            `K_i` for the competitor in M</span>
<span style="color: #35a69c; font-style: italic;">        Kd : float</span>
<span style="color: #35a69c; font-style: italic;">            `K_d` for the reporter in M</span>
<span style="color: #35a69c; font-style: italic;">        Et : float</span>
<span style="color: #35a69c; font-style: italic;">            total concentration of protein `E_t` in M</span>

<span style="color: #35a69c; font-style: italic;">        Returns</span>
<span style="color: #35a69c; font-style: italic;">        -------</span>
<span style="color: #35a69c; font-style: italic;">        f : float | np.array</span>
<span style="color: #35a69c; font-style: italic;">            fraction of reporter bound to protein in the presence of competitor</span>

<span style="color: #35a69c; font-style: italic;">    """</span>
    <span style="color: #268bd2;">a</span> = Kd + Ki + Lt + I + Et
    <span style="color: #268bd2;">b</span> = (I-Et)*Kd + (Lt-Et)*Ki + Kd*Ki
    <span style="color: #268bd2;">c</span> = -Kd*Ki*Et
    <span style="color: #268bd2;">theta</span> = np.arccos((-<span style="color: #6c71c4; font-weight: bold;">2</span>*a**<span style="color: #6c71c4; font-weight: bold;">3</span> + <span style="color: #6c71c4; font-weight: bold;">9</span>*a*b - <span style="color: #6c71c4; font-weight: bold;">27</span>*c)/(<span style="color: #6c71c4; font-weight: bold;">2</span>*np.sqrt((a**<span style="color: #6c71c4; font-weight: bold;">2</span>-<span style="color: #6c71c4; font-weight: bold;">3</span>*b)**<span style="color: #6c71c4; font-weight: bold;">3</span>)))
    <span style="color: #268bd2;">d</span> = <span style="color: #6c71c4; font-weight: bold;">2</span>*np.sqrt((a**<span style="color: #6c71c4; font-weight: bold;">2</span>-<span style="color: #6c71c4; font-weight: bold;">3</span>*b))*np.cos(theta/<span style="color: #6c71c4; font-weight: bold;">3</span>) - a
    <span style="color: #268bd2;">f</span> = d / (<span style="color: #6c71c4; font-weight: bold;">3</span>*Kd + d)
    <span style="color: #859900; font-weight: bold; font-style: italic;">return</span> f

<span style="color: #96A7A9; font-style: italic;"># </span><span style="color: #96A7A9; font-style: italic;">some fancy colors</span>
<span style="color: #268bd2;">cmap</span> = cm.viridis
<span style="color: #268bd2;">len_cycle</span> = <span style="color: #6c71c4; font-weight: bold;">7</span>
<span style="color: #268bd2;">c</span> = np.linspace(<span style="color: #6c71c4; font-weight: bold;">0</span>,<span style="color: #6c71c4; font-weight: bold;">1</span>,len_cycle)
<span style="color: #268bd2;">custom_cycler</span> = (cycler(color=[cmap(i) <span style="color: #859900; font-weight: bold; font-style: italic;">for</span> i <span style="color: #859900; font-weight: bold; font-style: italic;">in</span> c]))<span style="color: #96A7A9; font-style: italic;"># </span><span style="color: #96A7A9; font-style: italic;">+</span>
                 <span style="color: #96A7A9; font-style: italic;">#</span><span style="color: #96A7A9; font-style: italic;">cycler(lw=np.arange(len_cycle)+1))</span>

<span style="color: #96A7A9; font-style: italic;"># </span><span style="color: #96A7A9; font-style: italic;">configure plot</span>
fig = plt.figure(figsize=(<span style="color: #6c71c4; font-weight: bold;">8</span>,<span style="color: #6c71c4; font-weight: bold;">10</span>))
ax1 = fig.add_subplot(<span style="color: #6c71c4; font-weight: bold;">211</span>)
ax2 = fig.add_subplot(<span style="color: #6c71c4; font-weight: bold;">212</span>)
ax1.set_prop_cycle(custom_cycler)
ax2.set_prop_cycle(custom_cycler)

<span style="color: #96A7A9; font-style: italic;"># </span><span style="color: #96A7A9; font-style: italic;">set parameters</span>
Kis = np.logspace(-<span style="color: #6c71c4; font-weight: bold;">9</span>,-<span style="color: #6c71c4; font-weight: bold;">3</span>,len_cycle)
Lt = 50e-<span style="color: #6c71c4; font-weight: bold;">6</span>
Kds = [5e-<span style="color: #6c71c4; font-weight: bold;">6</span>,500e-<span style="color: #6c71c4; font-weight: bold;">6</span>]
Et = 1e-<span style="color: #6c71c4; font-weight: bold;">6</span>
I = np.logspace(-<span style="color: #6c71c4; font-weight: bold;">7</span>,-<span style="color: #6c71c4; font-weight: bold;">1</span>) <span style="color: #96A7A9; font-style: italic;"># </span><span style="color: #96A7A9; font-style: italic;">reporter concentration</span>

<span style="color: #96A7A9; font-style: italic;"># </span><span style="color: #96A7A9; font-style: italic;">calculate and plot</span>
axes = [ax1,ax2]
<span style="color: #859900; font-weight: bold; font-style: italic;">for</span> Kd,ax <span style="color: #859900; font-weight: bold; font-style: italic;">in</span> <span style="color: #d33682; font-style: italic;">zip</span>(Kds,axes):
    <span style="color: #859900; font-weight: bold; font-style: italic;">for</span> Ki <span style="color: #859900; font-weight: bold; font-style: italic;">in</span> Kis:
        Fw = calcF(I,Lt,Ki,Kd,Et)
        ax.semilogx(I,Fw,<span style="color: #2aa198;">"o-"</span>,label=f<span style="color: #2aa198;">"</span>{Ki:.1E}<span style="color: #2aa198;">"</span>)

    ax.grid(which=<span style="color: #2aa198;">'both'</span>,linestyle=<span style="color: #2aa198;">"--"</span>,alpha=<span style="color: #6c71c4; font-weight: bold;">0.75</span>)
    ax.set_ylabel(<span style="color: #2aa198;">"$f$"</span>)
    ax.set_xlabel(<span style="color: #2aa198;">"[I] (M)"</span>)
    ax.set_title(r<span style="color: #2aa198;">"$K_d$"</span>+f<span style="color: #2aa198;">" = </span>{Kd*1e6:.1f}<span style="color: #2aa198;"> &#956;M"</span>+r<span style="color: #2aa198;">", $L_t$"</span>+ f<span style="color: #2aa198;">" = </span>{Lt*1e6:.1f}<span style="color: #2aa198;"> &#956;M, "</span> + r<span style="color: #2aa198;">"$E_t$ "</span> + f<span style="color: #2aa198;">"= </span>{Et*1e6:.1f}<span style="color: #2aa198;"> &#956;M"</span>)
    ax.legend(title=r<span style="color: #2aa198;">"$K_i$ (M)"</span>)
plt.tight_layout()
fname = <span style="color: #2aa198;">"../static/fraction_bound_2.png"</span>
plt.savefig(fname)
<span style="color: #859900; font-weight: bold; font-style: italic;">return</span> fname
</pre>
</div>


<figure id="org89752ca">
<img src="../static/fraction_bound_2.png" alt="fraction_bound_2.png">

</figure>
</div>
</div>

<div id="outline-container-org3e5e38d" class="outline-3">
<h3 id="org3e5e38d">Assay quality metrics</h3>
<div class="outline-text-3" id="text-org3e5e38d">
<p>
Viriera and Ciulli (2019) have described an assay quality metric, \(C_2\), or contrast which is the fractional decrease in signal intensity in the presence of protein.
Larger \(C_2\) values are usually preferred as this improves the dynamic range of the assay.
</p>

\begin{equation}
C_2 = \frac{R_{2,+protein} - R_{2,free}}{R_{2,+protein}}
\end{equation}

<p>
Written in terms of intensity ratios this is equivalent to:
</p>

\begin{equation}
C_2 = \frac{ ln \left[ \frac{ I_{\tau,long,+protein} }{ I_{\tau,short,+protein} }\right] - ln \left[ \frac{ I_{\tau,long,free} }{ I_{\tau,short,free} } \right]} {ln \left[\frac{I_{\tau,long,+protein}}{I_{\tau,short,+protein}}\right]}
\end{equation}

<p>
Where \(\frac{ I_{\tau,long,+protein} }{ I_{\tau,short,+protein}}\) is the ratio of reporter signal intensities at the long and short delay time \(\tau\) in the presence of protein and \(\frac{ I_{\tau,long,free} }{ I_{\tau,short,free}}\) is the ratio of reporter signal intensities in the absence of protein at the long and short delay times, respectively.
</p>

<p>
Another useful metric for defining the quality of the reporter assay is the \(Z'\) score which was first described by Zhang, Chung and Oldenburg (1999) for use in high-throughput screening (HTS) applications.
</p>

\begin{equation}
Z' = 1-\frac{(3\sigma_{c+} + 3\sigma_{c-})}{|\mu_{c+}-\mu_{c-}|}
\end{equation}

<p>
Where \(\mu_{c+}\) and \(\mu_{c-}\) are the mean value for the positive (with protein) and negative (without protein) controls, respectively, and \(\sigma_{c+}\) and \(\sigma_{c-}\) are the standard deviations of the values for the positive and negative controls respectively.
Calculation of a reasonable \(Z'\) score would require that one includes \(>3\) control samples ( ideally more!).
\(Z'\) values of greater than 0.5 are considered to be good. However, as reported by Almeida, Panova and Walser (2021) \(Z'\) values greater than 0.8 should be achievable using the ratio of ratios method (see above) for an NMR reporter assay.
</p>
</div>
</div>
</div>

<div id="outline-container-org8532aba" class="outline-2">
<h2 id="org8532aba">Practice</h2>
<div class="outline-text-2" id="text-org8532aba">
</div>
<div id="outline-container-org9d33d33" class="outline-3">
<h3 id="org9d33d33">\(^1H\) vs \(^{19}F\)</h3>
<div class="outline-text-3" id="text-org9d33d33">
<p>
The fluorine nucleus has advantages over proton for use as a reporter
</p>

<ol class="org-ol">
<li>Background free</li>
<li>Highly sensitive to weak binding due to high chemical shift anisotropy (CSA) and large chemical shift difference between free and bound states</li>
</ol>

<p>
This means that high \(C_2\)  can be achieved relative to  \(^1H\) at a given concentration leading to wider assay dynamic range.
</p>
</div>
</div>

<div id="outline-container-org1da5fc0" class="outline-3">
<h3 id="org1da5fc0">Conditions</h3>
<div class="outline-text-3" id="text-org1da5fc0">
<p>
A good starting point is 1 μM protein and 50 μM reporter. However, there is no substitute for testing a few different protein and reporter concentrations to judge which provides the highest \(C_2\), \(Z'\) and \(\frac{S}{N}\) ratios. Vieira de Castro and Ciulli (2019) demonstrated this very clearly.
It is also a good idea to test multiple reporters across a range of affinities.
As was shown by Vieira de Castro and Ciulli (2019) the optimal reporter affinity can vary from 10s to 100s of μM.
</p>
</div>
</div>

<div id="outline-container-orgc5b0975" class="outline-3">
<h3 id="orgc5b0975">NMR experiments</h3>
<div class="outline-text-3" id="text-orgc5b0975">
<ol class="org-ol">
<li>T2 filtered experiments
<ul class="org-ul">
<li>CPMG for \(^{19}F\)</li>
<li>\(T_{1\rho}\) for \(^1H\)</li>
</ul></li>
</ol>
</div>
</div>
</div>

<div id="outline-container-orgb06e151" class="outline-2">
<h2 id="orgb06e151">References</h2>
<div class="outline-text-2" id="text-orgb06e151">
<ol class="org-ol">
<li><a href="https://doi.org/10.1039/c8cc09790a">Spy vs. spy: selecting the best reporter for 19 F NMR competition experiments</a>; Guilherme Vieira de Castro  and  Alessio Ciulli</li>
<li><a href="https://doi.org/10.1177/108705719900400206">A Simple Statistical Parameter for Use in Evaluation and Validation of High Throughput Screening Assays</a>; JH Zhang, TD Chung, KR Oldenburg</li>
<li><a href="https://doi.org/10.1177/24725552211009782">NMR Reporter Assays for the Quantification of Weak-Affinity Receptor-Ligand Interactions</a>; Teresa B Almeida, Stanislava Panova, Reto Walser</li>
<li><a href="https://doi.org/10.1177/1087057102239666">Fluorescence polarization competition assay: the range of resolvable inhibitor potency is limited by the affinity of the fluorescent ligand</a>;Xinyi Huang</li>
<li><a href="https://doi.org/10.1016/0014-5793(95)00062-e">An exact mathematical expression for describing competitive binding of two different ligands to a protein molecule</a>; Wang ZX</li>
</ol>
</div>
</div>

<div id="outline-container-orgb9869d0" class="outline-2">
<h2 id="orgb9869d0">Appendix</h2>
<div class="outline-text-2" id="text-orgb9869d0">
<p>
The protein concentration required for a given bound fraction of ligand is described by the following relationship:
</p>

\begin{equation}
P_0 = \frac{K_df_0}{1-f_0} + f_0L_0
\end{equation}

<button type="button" class="collapsible">Show code</button>
<div class="org-src-container">
<pre class="src src-python"><span style="color: #859900; font-weight: bold; font-style: italic;">import</span> numpy <span style="color: #859900; font-weight: bold; font-style: italic;">as</span> np
<span style="color: #859900; font-weight: bold; font-style: italic;">import</span> matplotlib
matplotlib.use(<span style="color: #2aa198;">'Agg'</span>)
<span style="color: #859900; font-weight: bold; font-style: italic;">import</span> matplotlib.pyplot <span style="color: #859900; font-weight: bold; font-style: italic;">as</span> plt
<span style="color: #859900; font-weight: bold; font-style: italic;">def</span> <span style="color: #b58900;">P0</span>(Kd,f0,L0):
    <span style="color: #859900; font-weight: bold; font-style: italic;">return</span> (Kd*f0)/(<span style="color: #6c71c4; font-weight: bold;">1</span>-f0) + f0*L0

<span style="color: #268bd2;">Kd</span> = np.array([<span style="color: #6c71c4; font-weight: bold;">10</span>,<span style="color: #6c71c4; font-weight: bold;">100</span>,<span style="color: #6c71c4; font-weight: bold;">1000</span>])
<span style="color: #268bd2;">f0</span> = <span style="color: #6c71c4; font-weight: bold;">0.05</span>
<span style="color: #268bd2;">L0</span> = <span style="color: #6c71c4; font-weight: bold;">10.0</span>
<span style="color: #268bd2;">p0</span> = P0(Kd, f0, L0)
<span style="color: #859900; font-weight: bold; font-style: italic;">return</span> p0
</pre>
</div>

<table>


<colgroup>
<col  class="org-right">

<col  class="org-right">

<col  class="org-right">
</colgroup>
<tbody>
<tr>
<td class="org-right">1.02631579</td>
<td class="org-right">5.76315789</td>
<td class="org-right">53.13157895</td>
</tr>
</tbody>
</table>

<hr>
<p>
<a href="../index.html">Back to main page</a>
</p>
<hr>


<script>
    var coll = document.getElementsByClassName("collapsible");
    var i;

    for (i = 0; i < coll.length; i++) {
        coll[i].addEventListener("click", function() {
            this.classList.toggle("active");
            var content = this.nextElementSibling;
            if (content.style.display === "block") {
                content.style.display = "none";
                } else {
                content.style.display = "block";
            }
        });
    }
</script>
</div>
</div>
</div>
<div id="postamble" class="status">
<p class="author">Author: Jacob P Brady (<a href="mailto:jacob.brady@protonmail.com">jacob.brady@protonmail.com</a>)</p><p class="creator"><a href="https://www.gnu.org/software/emacs/">Emacs</a> 28.2 (<a href="https://orgmode.org">Org</a> mode 9.6)</p><div id="updated">Updated: 2022-12-28 Wed 12:06</div>
</div>
</body>
</html>
